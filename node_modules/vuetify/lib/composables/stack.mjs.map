{"version":3,"file":"stack.mjs","names":["useToggleScope","computed","onScopeDispose","reactive","readonly","ref","watchEffect","getCurrentInstance","stack","useStack","isActive","zIndex","vm","_zIndex","value","lastZIndex","at","push","uid","idx","findIndex","v","splice","isTop","_isTop","setTimeout","stackStyles"],"sources":["../../src/composables/stack.ts"],"sourcesContent":["import { useToggleScope } from '@/composables/toggleScope'\n\nimport { computed, onScopeDispose, reactive, readonly, ref, watchEffect } from 'vue'\nimport { getCurrentInstance } from '@/util'\n\n// Types\nimport type { Ref } from 'vue'\n\nconst stack = reactive<[uid: number, zIndex: number][]>([])\n\nexport function useStack (isActive: Readonly<Ref<boolean>>, zIndex: Readonly<Ref<string | number>>) {\n  const vm = getCurrentInstance('useStack')\n\n  const _zIndex = ref(+zIndex.value)\n  useToggleScope(isActive, () => {\n    const lastZIndex = stack.at(-1)?.[1]\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : +zIndex.value\n    stack.push([vm.uid, _zIndex.value])\n\n    onScopeDispose(() => {\n      const idx = stack.findIndex(v => v[0] === vm.uid)\n      stack.splice(idx, 1)\n    })\n  })\n\n  const isTop = ref(true)\n  watchEffect(() => {\n    const _isTop = stack.at(-1)?.[0] === vm.uid\n    setTimeout(() => isTop.value = _isTop)\n  })\n\n  return {\n    isTop: readonly(isTop),\n    stackStyles: computed(() => ({ zIndex: _zIndex.value })),\n  }\n}\n"],"mappings":"SAASA,c;AAET,SAASC,QAAT,EAAmBC,cAAnB,EAAmCC,QAAnC,EAA6CC,QAA7C,EAAuDC,GAAvD,EAA4DC,WAA5D,QAA+E,KAA/E;SACSC,kB,6BAET;;AAGA,MAAMC,KAAK,GAAGL,QAAQ,CAAkC,EAAlC,CAAtB;AAEA,OAAO,SAASM,QAAT,CAAmBC,QAAnB,EAAqDC,MAArD,EAA6F;EAClG,MAAMC,EAAE,GAAGL,kBAAkB,CAAC,UAAD,CAA7B;;EAEA,MAAMM,OAAO,GAAGR,GAAG,CAAC,CAACM,MAAM,CAACG,KAAT,CAAnB;;EACAd,cAAc,CAACU,QAAD,EAAW,MAAM;IAAA;;IAC7B,MAAMK,UAAU,gBAAGP,KAAK,CAACQ,EAAN,CAAS,CAAC,CAAV,CAAH,qBAAG,UAAe,CAAf,CAAnB;IACAH,OAAO,CAACC,KAAR,GAAgBC,UAAU,GAAGA,UAAU,GAAG,EAAhB,GAAqB,CAACJ,MAAM,CAACG,KAAvD;IACAN,KAAK,CAACS,IAAN,CAAW,CAACL,EAAE,CAACM,GAAJ,EAASL,OAAO,CAACC,KAAjB,CAAX;IAEAZ,cAAc,CAAC,MAAM;MACnB,MAAMiB,GAAG,GAAGX,KAAK,CAACY,SAAN,CAAgBC,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAD,KAAST,EAAE,CAACM,GAAjC,CAAZ;MACAV,KAAK,CAACc,MAAN,CAAaH,GAAb,EAAkB,CAAlB;IACD,CAHa,CAAd;EAID,CATa,CAAd;EAWA,MAAMI,KAAK,GAAGlB,GAAG,CAAC,IAAD,CAAjB;EACAC,WAAW,CAAC,MAAM;IAAA;;IAChB,MAAMkB,MAAM,GAAG,eAAAhB,KAAK,CAACQ,EAAN,CAAS,CAAC,CAAV,iCAAe,CAAf,OAAsBJ,EAAE,CAACM,GAAxC;;IACAO,UAAU,CAAC,MAAMF,KAAK,CAACT,KAAN,GAAcU,MAArB,CAAV;EACD,CAHU,CAAX;EAKA,OAAO;IACLD,KAAK,EAAEnB,QAAQ,CAACmB,KAAD,CADV;IAELG,WAAW,EAAEzB,QAAQ,CAAC,OAAO;MAAEU,MAAM,EAAEE,OAAO,CAACC;IAAlB,CAAP,CAAD;EAFhB,CAAP;AAID"}